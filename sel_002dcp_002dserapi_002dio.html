<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- This file documents the Software Evolution library

Copyright (C) 2014-2018 Eric Schulte and GrammaTech

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3
or any later version published by the Free Software Foundation;
with the Invariant Section being "GNU GENERAL PUBLIC LICENSE,"
A copy of the license is included in the section entitled
"GNU Free Documentation License." -->
<!-- Created by GNU Texinfo 6.5, http://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>sel-cp-serapi-io (Software Evolution Library)</title>

<meta name="description" content="sel-cp-serapi-io (Software Evolution Library)">
<meta name="keywords" content="sel-cp-serapi-io (Software Evolution Library)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="index.html#Top" rel="start" title="Top">
<link href="Index.html#Index" rel="index" title="Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="SEL-Packages.html#SEL-Packages" rel="up" title="SEL Packages">
<link href="sel_002dcp_002dtest_002dsuite.html#sel_002dcp_002dtest_002dsuite" rel="next" title="sel-cp-test-suite">
<link href="sel_002dcp_002dsearchable.html#sel_002dcp_002dsearchable" rel="prev" title="sel-cp-searchable">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
blockquote.smallindentedblock {margin-right: 0em; font-size: smaller}
blockquote.smallquotation {font-size: smaller}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
div.smalldisplay {margin-left: 3.2em}
div.smallexample {margin-left: 3.2em}
div.smalllisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: inherit; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: inherit; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="en">
<a name="sel_002dcp_002dserapi_002dio"></a>
<div class="header">
<p>
Next: <a href="sel_002dcp_002dtest_002dsuite.html#sel_002dcp_002dtest_002dsuite" accesskey="n" rel="next">sel-cp-test-suite</a>, Previous: <a href="sel_002dcp_002dsearchable.html#sel_002dcp_002dsearchable" accesskey="p" rel="prev">sel-cp-searchable</a>, Up: <a href="SEL-Packages.html#SEL-Packages" accesskey="u" rel="up">SEL Packages</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html#Index" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<a name="sel_002dcp_002dserapi_002dio-1"></a>
<h3 class="section">C.60 sel-cp-serapi-io</h3>
<a name="Condition-serapi_002dtimeout_002derror"></a><dl>
<dt><a name="index-serapi_002dtimeout_002derror"></a>Condition: <strong>serapi-timeout-error</strong></dt>
<dd><p>Class precedence list: <code>serapi-timeout-error, error, serious-condition, condition, t</code>
</p>
<p>Condition raised if timeout is exceeded.
</p></dd></dl>
<a name="Variable-_002aserapi_002dprocess_002a"></a><dl>
<dt><a name="index-_002aserapi_002dprocess_002a"></a>Variable: <strong>*serapi-process*</strong></dt>
<dd><p>Main SerAPI process. Ensure new threads each have their own copy or else.
</p></dd></dl>
<a name="Variable-_002aserapi_002dtimeout_002a"></a><dl>
<dt><a name="index-_002aserapi_002dtimeout_002a"></a>Variable: <strong>*serapi-timeout*</strong></dt>
<dd><p>Maximum amount of time to wait before determining that no data can be read.
</p></dd></dl>
<a name="Variable-_002asertop_002dargs_002a"></a><dl>
<dt><a name="index-_002asertop_002dargs_002a"></a>Variable: <strong>*sertop-args*</strong></dt>
<dd><p>Arguments to sertop program.
</p></dd></dl>
<a name="Variable-_002asertop_002dpath_002a"></a><dl>
<dt><a name="index-_002asertop_002dpath_002a"></a>Variable: <strong>*sertop-path*</strong></dt>
<dd><p>Path to sertop program.
</p></dd></dl>
<a name="Macro-with_002dserapi"></a><dl>
<dt><a name="index-with_002dserapi"></a>Macro: <strong>with-serapi</strong> <em>(&amp;optional process) &amp;body body</em></dt>
<dd><p>Macro to create a serapi process bound to <code>serapi</code>.
Uses default path and arguments for sertop (&lsquo;*sertop-path*&rsquo; and
&lsquo;*sertop-args*&rsquo;).
</p></dd></dl>
<a name="Function-add_002dcoq_002dstring"></a><dl>
<dt><a name="index-add_002dcoq_002dstring"></a>Function: <strong>add-coq-string</strong> <em>coq-string &amp;key qtag</em></dt>
<dd><p>Submit <code>coq-string</code> as a new statement to add to the Coq document.
Return a list of the AST-IDs created as a result. Optionally, provide a <code>qtag</code> for
the submission.
</p></dd></dl>
<a name="Function-added_002did"></a><dl>
<dt><a name="index-added_002did"></a>Function: <strong>added-id</strong> <em>sexpr</em></dt>
<dd><p>For an Added response <code>sexpr</code>, a response from SerAPI, return the AST <code>id</code> added.
Return <code>nil</code> if <code>sexpr</code> is not an Added response.
</p></dd></dl>
<a name="Function-answer_002dast"></a><dl>
<dt><a name="index-answer_002dast"></a>Function: <strong>answer-ast</strong> <em>sexpr</em></dt>
<dd><p>For an ObjList response <code>sexpr</code>, a response from SerAPI, return the CoqAst list.
Return <code>nil</code> if <code>sexpr</code> is not an ObjList or does not contain a CoqAst.
</p></dd></dl>
<a name="Function-answer_002dcontent"></a><dl>
<dt><a name="index-answer_002dcontent"></a>Function: <strong>answer-content</strong> <em>sexpr</em></dt>
<dd><p>For an Answer response from SerAPI, <code>sexpr</code>, return the content.
Return <code>nil</code> if <code>sexpr</code> is not an Answer response.
</p></dd></dl>
<a name="Function-answer_002dstring"></a><dl>
<dt><a name="index-answer_002dstring"></a>Function: <strong>answer-string</strong> <em>sexpr</em></dt>
<dd><p>For an ObjList in <code>sexpr</code>, a response from SerAPI, return the CoqString string.
Return <code>nil</code> if <code>sexpr</code> is not an ObjList or does not contain a CoqString.
</p></dd></dl>
<a name="Function-cancel_002dcoq_002dasts"></a><dl>
<dt><a name="index-cancel_002dcoq_002dasts"></a>Function: <strong>cancel-coq-asts</strong> <em>ast-ids &amp;key qtag</em></dt>
<dd><p>Cancel the ASTs identified by <code>ast-ids</code> and return the response.
Optionally, use <code>qtag</code> to tag the query. Canceling means that the ASTs will no
longer be defined and other definitions added in the interim will also be
removed.
</p></dd></dl>
<a name="Function-feedback_002dcontents"></a><dl>
<dt><a name="index-feedback_002dcontents"></a>Function: <strong>feedback-contents</strong> <em>sexpr</em></dt>
<dd><p>For a Feedback response from SerAPI, <code>sexpr</code>, return the contents.
Return <code>nil</code> if <code>sexpr</code> is not a Feedback response.
</p></dd></dl>
<a name="Function-feedback_002did"></a><dl>
<dt><a name="index-feedback_002did"></a>Function: <strong>feedback-id</strong> <em>sexpr</em></dt>
<dd><p>For a Feedback response from SerAPI, <code>sexpr</code>, return the id.
Return <code>nil</code> if <code>sexpr</code> is not a Feedback response.
</p></dd></dl>
<a name="Function-feedback_002droute"></a><dl>
<dt><a name="index-feedback_002droute"></a>Function: <strong>feedback-route</strong> <em>sexpr</em></dt>
<dd><p>For a Feedback response from SerAPI, <code>sexpr</code>, return the route
Return <code>nil</code> if <code>sexpr</code> is not a Feedback response.
</p></dd></dl>
<a name="Function-insert_002dreset_002dpoint"></a><dl>
<dt><a name="index-insert_002dreset_002dpoint"></a>Function: <strong>insert-reset-point</strong></dt>
<dd><p>Insert a reset point so &lsquo;*serapi-process*&rsquo; may be reset to its current state.
Add Coq &lsquo;*dummy-stmt*&rsquo; to &lsquo;*serapi-process*&rsquo; and update &lsquo;reset-points&rsquo; with the
AST <code>id</code>. See also &lsquo;reset-serapi-process&rsquo;.
</p></dd></dl>
<a name="Generic_002dFunction-is_002derror"></a><dl>
<dt><a name="index-is_002derror"></a>Generic Function: <strong>is-error</strong> <em>output</em></dt>
<dd><p>Check if <code>output</code> is an error response from SerAPI.
</p></dd></dl>
<a name="Method-is_002derror-_0028_0028sexpr-list_0029_0029"></a><dl>
<dt><a name="index-is_002derror-1"></a>Method: <strong>is-error</strong> <em>(sexpr list)</em></dt>
<dd><p>Return <code>t</code> if <code>sexpr</code> is an error message from either an improperly formed SerAPI
command or an invalid Coq command, <code>nil</code> otherwise.
</p></dd></dl>
<a name="Method-is_002derror-_0028_0028str-string_0029_0029"></a><dl>
<dt><a name="index-is_002derror-2"></a>Method: <strong>is-error</strong> <em>(str string)</em></dt>
<dd><p>Check if <code>str</code> is an error message.
Errors may result from either an improperly formed SerAPI command or an invalid
Coq command.
</p></dd></dl>
<a name="Function-is_002dimport_002dast"></a><dl>
<dt><a name="index-is_002dimport_002dast"></a>Function: <strong>is-import-ast</strong> <em>sexpr</em></dt>
<dd><p>Return <code>t</code> if <code>sexpr</code> is tagged as as VernacImport or VernacRequire, <code>nil</code>
otherwise.
</p></dd></dl>
<a name="Function-is_002dloc_002dinfo"></a><dl>
<dt><a name="index-is_002dloc_002dinfo"></a>Function: <strong>is-loc-info</strong> <em>sexpr</em></dt>
<dd><p>Return <code>t</code> if <code>sexpr</code> is a list of Coq location info, <code>nil</code> otherwise.
</p></dd></dl>
<a name="Generic_002dFunction-is_002dterminating"></a><dl>
<dt><a name="index-is_002dterminating"></a>Generic Function: <strong>is-terminating</strong> <em>output</em></dt>
<dd><p>Check if <code>output</code> is indicates the end of a SerAPI response.
</p></dd></dl>
<a name="Method-is_002dterminating-_0028_0028sexpr-list_0029_0029"></a><dl>
<dt><a name="index-is_002dterminating-1"></a>Method: <strong>is-terminating</strong> <em>(sexpr list)</em></dt>
<dd><p>Return <code>t</code> if <code>sexpr</code> is the final message in a SerAPI response, <code>nil</code> otherwise.
For successful responses, the list will be tagged as &quot;Completed&quot;, and
for failed responses it will be tagged as an error.
</p></dd></dl>
<a name="Method-is_002dterminating-_0028_0028str-string_0029_0029"></a><dl>
<dt><a name="index-is_002dterminating-2"></a>Method: <strong>is-terminating</strong> <em>(str string)</em></dt>
<dd><p>Check if <code>str</code> is the final message in a SerAPI response.
For successful responses, the string will contain the word &quot;Completed&quot;, and
for failed responses it will be an error string.
</p></dd></dl>
<a name="Function-lib_002dadd"></a><dl>
<dt><a name="index-lib_002dadd"></a>Function: <strong>lib-add</strong> <em>path &amp;key lib-name has-ml qtag</em></dt>
<dd><p>Add directory <code>path</code> to the Coq and, optionally, <code>ml</code> load paths in SerAPI.
Return the SerAPI response.
* <code>lib-name</code> an optional prefix to use when importing from the directory. <code>e</code>.g.,
for <code>lib-name</code> Foo, file PATH/Bar.vo could be imported with
&quot;Require Import Foo.Bar.&quot;).
* <code>has-ml</code> the string &quot;true&quot; or &quot;false&quot;, indicating whether <code>path</code> should or
should not be added to the <code>ml</code> load path in addition to the Coq load path. For
convenience, the default is &quot;true&quot;.
* <code>qtag</code> optionally, a tag to use for the SerAPI command.
</p></dd></dl>
<a name="Function-load_002dcoq_002dfile"></a><dl>
<dt><a name="index-load_002dcoq_002dfile"></a>Function: <strong>load-coq-file</strong> <em>file-name &amp;key qtag</em></dt>
<dd><p>Load Coq file <code>file-name</code>. Optionally, use <code>qtag</code> to tag the query.
Return a list of IDs for the ASTs that were added.
</p></dd></dl>
<a name="Generic_002dFunction-lookup_002dcoq_002dast"></a><dl>
<dt><a name="index-lookup_002dcoq_002dast"></a>Generic Function: <strong>lookup-coq-ast</strong> <em>ast-id &amp;key qtag</em></dt>
<dd><p>Look up and return the AST identified by <code>ast-id</code>.
Optionally, use <code>qtag</code> to tag the query.
</p></dd></dl>
<a name="Method-lookup_002dcoq_002dast-_0028_0028ast_002did-integer_0029-_0026key-_0028qtag-_0028gensym-q_0029_0029_0029"></a><dl>
<dt><a name="index-lookup_002dcoq_002dast-1"></a>Method: <strong>lookup-coq-ast</strong> <em>(ast-id integer) &amp;key (qtag (gensym q))</em></dt>
<dd><p>Look up and return the AST whose <code>id</code> is the integer <code>ast-id</code>.
Optionally, use <code>qtag</code> to tag the query.
</p></dd></dl>
<a name="Generic_002dFunction-lookup_002dcoq_002dpp"></a><dl>
<dt><a name="index-lookup_002dcoq_002dpp"></a>Generic Function: <strong>lookup-coq-pp</strong> <em>ast-name &amp;key qtag</em></dt>
<dd><p>Look up and return a Coq representation of <code>ast-name</code>.
Optionally, tag the lookup query with <code>qtag</code>.
</p></dd></dl>
<a name="Generic_002dFunction-lookup_002dcoq_002dstring"></a><dl>
<dt><a name="index-lookup_002dcoq_002dstring"></a>Generic Function: <strong>lookup-coq-string</strong> <em>id &amp;key qtag input-format</em></dt>
<dd><p>Look up the Coq string for <code>id</code>.
If needed specify the <code>input-format</code> of the <code>id</code>. Optionally,  provide a <code>qtag</code> for
the lookup query.
</p>
<p>The <code>id</code> may be either an integer AST <code>id</code> or one of the list representations,
CoqPp, CoqAst, etc.
</p></dd></dl>
<a name="Method-lookup_002dcoq_002dstring-_0028_0028ast_002did-integer_0029-_0026key-_0028qtag-_0028gensym-q_0029_0029-input_002dformat_0029"></a><dl>
<dt><a name="index-lookup_002dcoq_002dstring-1"></a>Method: <strong>lookup-coq-string</strong> <em>(ast-id integer) &amp;key (qtag (gensym q)) input-format</em></dt>
<dd><p>Look up the Coq string for <code>id</code> in <code>process</code>.
Optionally, provide a <code>qtag</code> for the lookup query. <code>input-format</code> is ignored.
</p></dd></dl>
<a name="Method-lookup_002dcoq_002dstring-_0028_0028pp_002dstring-list_0029-_0026key-_0028qtag-_0028gensym-p_0029_0029-_0028input_002dformat-_0027coqast_0029_0029"></a><dl>
<dt><a name="index-lookup_002dcoq_002dstring-2"></a>Method: <strong>lookup-coq-string</strong> <em>(pp-string list) &amp;key (qtag (gensym p)) (input-format (quote coqast))</em></dt>
<dd><p>Look up the Coq string for <code>pp-string</code>.
If <code>pp-string</code> is not a CoqAst expression, specify the <code>input-format</code>. See the
coq_object type in the SerAPI file serapi/serapi_protocol.mli for a complete
list. Optionally, provide a <code>qtag</code> for the lookup query.
</p></dd></dl>
<a name="Function-make_002dserapi"></a><dl>
<dt><a name="index-make_002dserapi"></a>Function: <strong>make-serapi</strong> <em>&amp;optional program args</em></dt>
<dd><p>Start up SerAPI and return a <code>process</code> object to interact with.
</p></dd></dl>
<a name="Function-message_002dcontent"></a><dl>
<dt><a name="index-message_002dcontent"></a>Function: <strong>message-content</strong> <em>message</em></dt>
<dd><p>For a Message response from SerAPI, <code>message</code>, return the content.
Return <code>nil</code> if <code>message</code> is not a Message response.
</p></dd></dl>
<a name="Function-reset_002dserapi_002dprocess"></a><dl>
<dt><a name="index-reset_002dserapi_002dprocess"></a>Function: <strong>reset-serapi-process</strong></dt>
<dd><p>Reset &lsquo;*serapi-process*&rsquo; to the last reset point in its &lsquo;reset-points&rsquo;.
See also &lsquo;insert-reset-point&rsquo;.
</p></dd></dl>
<a name="Function-sanitize_002dprocess_002dstring"></a><dl>
<dt><a name="index-sanitize_002dprocess_002dstring"></a>Function: <strong>sanitize-process-string</strong> <em>string</em></dt>
<dd><p>Ensure that special characters are properly escaped in <code>string</code>.
</p></dd></dl>
<a name="Function-set_002dserapi_002dpaths"></a><dl>
<dt><a name="index-set_002dserapi_002dpaths"></a>Function: <strong>set-serapi-paths</strong></dt>
<dd><p>Function to set &lsquo;*sertop-path*&rsquo; and &lsquo;*sertop-args*&rsquo; automatically.
Uses <code>serapi</code> environment variable or &quot;which sertop.native&quot; to set
&lsquo;*sertop-path*&rsquo;. Uses <code>coqlib</code> environment variable to add &quot;&ndash;coqlib&quot; flag
to &lsquo;*sertop-args*&rsquo;.
</p></dd></dl>
<a name="Function-unescape_002dstring"></a><dl>
<dt><a name="index-unescape_002dstring"></a>Function: <strong>unescape-string</strong> <em>str</em></dt>
<dd><p>Remove extra escape characters from <code>str</code> prior to writing to screen or file.
Control characters for whitespace (\n, \t, \b, \r) and double quotes (&quot;)
are preceded by an extra pair of backslashes. See also &lsquo;escape-string&rsquo;.
</p></dd></dl>

<hr>
<div class="header">
<p>
Next: <a href="sel_002dcp_002dtest_002dsuite.html#sel_002dcp_002dtest_002dsuite" accesskey="n" rel="next">sel-cp-test-suite</a>, Previous: <a href="sel_002dcp_002dsearchable.html#sel_002dcp_002dsearchable" accesskey="p" rel="prev">sel-cp-searchable</a>, Up: <a href="SEL-Packages.html#SEL-Packages" accesskey="u" rel="up">SEL Packages</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html#Index" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
